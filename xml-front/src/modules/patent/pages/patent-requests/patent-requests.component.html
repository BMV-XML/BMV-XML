
<div class="filter" [formGroup]="searchFormGroup">

  <div class="row" [formGroup]="filterFormGroup">
    <div class="col-1 input">
    </div>
    <div class="col-2 input">
      <mat-form-field [ngStyle]="{'width': '200px'}" appearance="fill">
        <mat-label>Tip</mat-label>
        <mat-select formControlName="type">
          <mat-option *ngFor="let op of type_options" [value]="op.value">
            {{op.name}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-2 input">
      <mat-form-field class="input" appearance="fill">
        <mat-label>Tekst</mat-label>
        <input formControlName="text" matInput placeholder="xxxxxx">
      </mat-form-field>
    </div>

    <div class="col-3"></div>
    <div class="col-2">
      <mat-form-field appearance="fill">
        <mat-label>Unosite interval</mat-label>
        <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
          <input matStartDate formControlName="start" placeholder="Početni datum">
          <input matEndDate formControlName="end" placeholder="Krajnji datum">
        </mat-date-range-input>
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-date-range-picker #picker></mat-date-range-picker>

        <mat-error *ngIf="range.controls.start.hasError('matStartDateInvalid')">Početni datum nije validan</mat-error>
        <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')">Krajnji datum nije validan</mat-error>
      </mat-form-field>
    </div>
    <div class="col-1">
      <div class="px-2 py-2">
      <button class="mx-5" (click)="makeReport()" mat-raised-button>Preuzmi izveštaj</button>
      </div>
    </div>
  </div>
  <ng-template #viewContainerRef>
  </ng-template>
  <div class="row mb-4">
    <div class="col-2">
      <button mat-raised-button (click)="addFilterElement()">Dodaj element</button>
    </div>
    <div class="col-2">
      <button mat-raised-button (click)="removeFilterElement()">Skloni element</button>
    </div>
    <div class="col-1">
      <button mat-raised-button (click)="filterRequests()">Filter</button>
    </div>
  </div>
  <!--
  <div class="row">
    <div class="col-1 input">
      <mat-form-field [ngStyle]="{'width': '100px'}" appearance="fill">
        <mat-label>Operator</mat-label>
        <mat-select formControlName="numberOperator">
          <mat-option *ngFor="let op of options" [value]="op">
            {{op}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-2 input">
      <mat-form-field class="input" appearance="fill">
        <mat-label>Broj prijave</mat-label>
        <input matInput placeholder="P-0000/00" formControlName="number">
      </mat-form-field>
    </div>
    <div class="col-1 input">
      <mat-form-field [ngStyle]="{'width': '100px'}" appearance="fill">
        <mat-label>Operator</mat-label>
        <mat-select formControlName="titleOperator">
          <mat-option *ngFor="let op of options" [value]="op">
            {{op}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-2 input">
      <mat-form-field class="input" appearance="fill">
        <mat-label>Naslov</mat-label>
        <input matInput placeholder="naslov" formControlName="title">
      </mat-form-field>
    </div>
    <div class="col-1 input">
      <mat-form-field [ngStyle]="{'width': '100px'}" appearance="fill">
        <mat-label>Operator</mat-label>
        <mat-select formControlName="datumOperator">
          <mat-option *ngFor="let op of options" [value]="op">
            {{op}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-2 input">
      <mat-form-field class="mx-1" appearance="fill">
        <mat-label>Izaberi datum</mat-label>
        <input matInput [matDatepicker]="picker" formControlName="chosenDate">
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
      </mat-form-field>
    </div>
    <div class="col-1 mx-3 my-2 input">
    </div>
  </div>
  <div class="row">
    <div class="col-1 input">
      <mat-form-field [ngStyle]="{'width': '100px'}" appearance="fill">
        <mat-label>Operator</mat-label>
        <mat-select formControlName="submitterOperator">
          <mat-option *ngFor="let op of options" [value]="op">
            {{op}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-2 input">
      <mat-form-field class="input" appearance="fill">
        <mat-label>Podnosilac</mat-label>
        <input matInput placeholder="Petar" formControlName="submitter">
      </mat-form-field>
    </div>
    <div class="col-1 input">
      <mat-form-field [ngStyle]="{'width': '100px'}" appearance="fill">
        <mat-label>Operator</mat-label>
        <mat-select formControlName="commissionerOperator">
          <mat-option *ngFor="let op of options" [value]="op">
            {{op}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-2">
      <mat-form-field class="input" appearance="fill">
        <mat-label>Punomoćnik</mat-label>
        <input matInput placeholder="Petra" formControlName="commissioner">
      </mat-form-field>
    </div>
    <div class="col-1 input">
      <mat-form-field [ngStyle]="{'width': '100px'}" appearance="fill">
        <mat-label>Operator</mat-label>
        <mat-select formControlName="inventorOperator">
          <mat-option *ngFor="let op of options" [value]="op">
            {{op}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class="col-2">
      <mat-form-field class="input" appearance="fill">
        <mat-label>Pronalazač</mat-label>
        <input matInput placeholder="Lazar" formControlName="inventor">
      </mat-form-field>
    </div>
    <div class="col-1 my-2 mx-4">
      <button mat-raised-button (click)="filterRequests()">Filter</button>
    </div>
  </div>
  -->

  <div class="row">
    <div class="col-6">
      <mat-form-field id="grid" class="example-chip-list" appearance="fill">
        <mat-label>Termini za pretragu</mat-label>
        <mat-chip-grid  #chipGrid aria-label="Unos termina">
          <mat-chip-row *ngFor="let fruit of fruits"
                        (removed)="remove(fruit)"
                        [editable]="true"
                        (edited)="edit(fruit, $event)"
                        [aria-description]="'press enter to edit ' + fruit.name">
            {{fruit.name}}
            <button matChipRemove [attr.aria-label]="'remove ' + fruit.name">
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip-row>
          <input placeholder="Novi termin..."
                 [matChipInputFor]="chipGrid"
                 [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                 [matChipInputAddOnBlur]="true"
                 (matChipInputTokenEnd)="add($event)"/>
        </mat-chip-grid>
      </mat-form-field>
    </div>
    <div class="col-1 my-2 mx-4">
      <button mat-raised-button (click)="search()">Pretraži</button>
    </div>
  </div>
</div>

<p-table [value]="patents" styleClass="p-datatable-striped" [tableStyle]="{'min-width': '50rem'}">
  <ng-template pTemplate="header">
    <tr>
      <th>Code</th>
      <th>Datum podnosenja</th>
      <th>Podnosilac</th>
      <th> PDF</th>
      <th> HTML</th>
      <th> RDF</th>
      <th> JSON</th>
      <th> Donesi rešenje</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-patent>
    <tr (click)="getURL(patent.id)">
      <td>{{patent.id[0]}}</td>
      <td>{{patent.applicationDate | dateArrayToString}}</td>
      <td>{{patent.submitter[0]}}</td>
      <th>
        <button pButton class="p-button-sm" (click)="getPDF($event, patent.id[0])"> PDF</button>
      </th>
      <th>
        <button pButton class="p-button-sm" (click)="getHTML($event, patent.id[0])"> HTML</button>
      </th>
      <th>
        <button pButton class="p-button-sm" (click)="getRDF($event, patent.id[0])"> RDF</button>
      </th>
      <th>
        <button pButton class="p-button-sm" (click)="getJSON($event, patent.id[0])"> JSON</button>
      </th>
      <th>
        <button pButton class="p-button-sm" *ngIf="patent.hasSolution[0] === 'false'"
                (click)="openAddSolutionDialog($event, patent.id[0])"> Dodaj rešenje
        </button>
        <button pButton class="p-button-sm" *ngIf="patent.hasSolution[0] === 'true'"
                (click)="openViewSolutionDialog($event, patent.id[0])"> Vidi rešenje
        </button>
      </th>
    </tr>
  </ng-template>
</p-table>

<p-toast position="top-right" key="patent-list-message"></p-toast>
